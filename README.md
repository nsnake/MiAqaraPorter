# MiAqaraPorter

绿米(aqara)、米家智能家庭(mijia)数据搬运工

本项目的目地是采集米家网关下各种传感器的数据给天猫精灵使用。此项目只实现了最基础的数据采集和发送。

目前已在[Omega2 Plus](https://onion.io/)上正常运行，理论上也可在各种路由器或者NAS上运行。


# 前置条件:

需要开通了局域网通信协议的米家或者绿米智能网关并且能正常连网

根据情况连入自己所需的传感器

安装了node4的机器

开通米家网关的第三方接入功能，并且先获取相关传感器的的sid留着后面使用（接入方式可以参考下面的其它章节）

# 使用方法:

下载代码后修改MiAqaraPorter.js

修改porterTarget中的相关配置为你自己接受数据的服务器地址

修改event中的方法，按需来获取相关设备的信息

目前只实现了米家温湿度传感器（sensor_ht）的消息触发，有其它需要的设备可以修改handleData部分的代码实现接入。

修改完成后即可执行node MiAqaraPorter.js来启动服务。


# 原理：

让程序运行的机器和米家网关在同一个局域网内，程序通过udp组播的方式可以获取网关信息。

程序定时向米家网关请求指定传感器的数据。获取后通过http的方式通告给指定的服务端。

如需知道具体连入方式可以参考绿米网关局域网通信协议


# 其它

本项目参考了[mi-aqara-sdk](https://github.com/zzyss86/mi-aqara-sdk)

如果机器环境可以在node6以上版本执行的话，可以使用该sdk去实现更强的功能。
